jQuery(document).ready(function(i){"use strict";i.wc_product_vendors_admin={init:function(){i("#your-profile tr.show-admin-bar").remove(),wcpv_admin_local.isPendingVendor&&i("#dashboard-widgets").html('<p class="wcpv-pending-vendor-message">'+wcpv_admin_local.pending_vendor_message+"</p>"),i(".taxonomy-wcpv_product_vendors, .toplevel_page_wcpv-vendor-settings").on("click",".wcpv-upload-logo",function(t){t.preventDefault();var t=wcpv_admin_local,n=i(this).parents(".form-field").find('input[name="vendor_data[logo]"]'),e=i(this).parents(".form-field").find(".wcpv-logo-preview-image"),o=wp.media.frames.mediaFrame=wp.media({title:t.modalLogoTitle,button:{text:t.buttonLogoText},library:{type:"image"},multiple:!1});o.on("select",function(){o.state().get("selection").map(function(t){(t=t.toJSON()).id&&(n.val(t.id),e.prop("src",t.url).removeClass("hide"),i(n).parents(".form-field").find(".wcpv-remove-image").show())})}),o.open()}),i(".taxonomy-wcpv_product_vendors, .toplevel_page_wcpv-vendor-settings").on("click",".wcpv-remove-image",function(t){t.preventDefault(),i(this).hide(),i(this).parents(".form-field").find(".wcpv-logo-preview-image").prop("src","").addClass("hide"),i('input[name="vendor_data[logo]"]').val("")}),i(document.body).on("variable_vendor_commission",function(t){var n=window.prompt(woocommerce_admin_meta_boxes_variations.i18n_enter_a_value);null!=n&&i(':input[name^="_wcpv_product_variation_commission"]').val(n).trigger("change")}),i(".chart-widget .wcpv-vendor-search").length&&(n={formatMatches:function(t){return 1===t?wcpv_admin_local.i18n_matches_1:wcpv_admin_local.i18n_matches_n.replace("%qty%",t)},formatNoMatches:function(){return wcpv_admin_local.i18n_no_matches},formatAjaxError:function(){return wcpv_admin_local.i18n_ajax_error},formatInputTooShort:function(t,n){n-=t.length;return 1==n?wcpv_admin_local.i18n_input_too_short_1:wcpv_admin_local.i18n_input_too_short_n.replace("%qty%",n)},formatInputTooLong:function(t,n){t=t.length-n;return 1==t?wcpv_admin_local.i18n_input_too_long_1:wcpv_admin_local.i18n_input_too_long_n.replace("%qty%",t)},formatSelectionTooBig:function(t){return 1===t?wcpv_admin_local.i18n_selection_too_long_1:wcpv_admin_local.i18n_selection_too_long_n.replace("%qty%",t)},formatLoadMore:function(){return wcpv_admin_local.i18n_load_more},formatSearching:function(){return wcpv_admin_local.i18n_searching}},i(".wcpv-vendor-search-bar").filter(":not(.enhanced)").each(function(){var t={allowClear:!!i(this).data("allow_clear"),placeholder:i(this).data("placeholder"),minimumInputLength:i(this).data("minimum_input_length")?i(this).data("minimum_input_length"):"3",escapeMarkup:function(t){return t},ajax:{url:wcpv_admin_local.ajaxurl,dataType:"json",quietMillis:250,data:function(t){return{term:t,action:"wcpv_vendor_search_ajax",security:wcpv_admin_local.vendor_search_nonce}},processResults:function(t){var e=[];return t&&i.each(t,function(t,n){e.push({id:t,text:n})}),{results:e}},cache:!0}};!0===i(this).data("multiple")?(t.multiple=!0,t.initSelection=function(e,t){var o=JSON.parse(e.attr("data-selected")),a=[];return i(e.val().split(",")).each(function(t,n){a.push({id:n,text:o[n]||e.data("placeholder")})}),t(a)},t.formatSelection=function(t){return'<div class="selected-option" data-id="'+t.id+'">'+t.text+"</div>"}):(t.multiple=!1,t.initSelection=function(t,n){return n({id:t.val(),text:t.attr("data-selected")||t.data("placeholder")})}),t=i.extend(t,n),i(this).select2(t).addClass("enhanced")}));var n,e,t=document.createElement("a");function o(t,n){var e=document.createElement("a");e.download=t,e.href=n,i(e).hide(),i(e).addClass("pv-temp-download"),i("body").append(e),e.click()}void 0===t.download&&(i(".wcpv-export-commissions-button").hide(),i(".wcpv-export-unpaid-commissions-button").hide(),i(t).remove()),i(document.body).on("click",".wcpv-export-commissions-button",function(t){t.preventDefault(),i(".pv-temp-download").remove();var t={action:"wcpv_export_commissions_ajax",nonce:i(this).data("nonce"),order_id:i(this).data("order_id"),year:i(this).data("year"),month:i(this).data("month"),vendor:i(this).data("vendor"),commission_status:i(this).data("commission_status")},n=i(this).prop("download");i.post(wcpv_admin_local.ajaxurl,t).done(function(t){o(n,"data:application/csv;charset=utf-8,"+encodeURIComponent(t))})}),i(document.body).on("click",".wcpv-export-unpaid-commissions-button",function(t){t.preventDefault(),i(".pv-temp-download").remove();var t={action:"wcpv_export_unpaid_commissions_ajax",nonce:i(this).data("nonce")},n=i(this).prop("download");i.post(wcpv_admin_local.ajaxurl,t).done(function(t){o(n,"data:application/csv;charset=utf-8,"+encodeURIComponent(t))})}),i("#wcpv_vendor_settings_paypal_masspay_environment").on("change",function(){var t=i("#wcpv_vendor_settings_paypal_masspay_client_id_live").parents("tr").eq(0),n=i("#wcpv_vendor_settings_paypal_masspay_client_secret_live").parents("tr").eq(0),e=i("#wcpv_vendor_settings_paypal_masspay_client_id_sandbox").parents("tr").eq(0),o=i("#wcpv_vendor_settings_paypal_masspay_client_secret_sandbox").parents("tr").eq(0);"sandbox"===i(this).val()?(t.hide(),n.hide(),e.show(),o.show()):(t.show(),n.show(),e.hide(),o.hide())}).trigger("change"),i(document.body).on("click",".wcpv-term-additional-settings-link",function(t){t.preventDefault(),i(".wcpv-term-additional-settings").slideToggle()}),i("#wcpv_product_split_tax,#wcpv-split-tax").on("click",function(t){this.checked&&i("#wcpv_product_pass_tax,#wcpv-pass-tax").prop("checked",!1)}),i("#wcpv_product_pass_tax,#wcpv-pass-tax").on("click",function(t){this.checked&&i("#wcpv_product_split_tax,#wcpv-split-tax").prop("checked",!1)}),i("#wcpv_vendor_info").length&&null!=window.tinymce&&(e=tinymce.get("wcpv_vendor_info")).on("change",function(t){i("#wcpv_vendor_info").val(e.getContent())})}},i.wc_product_vendors_admin.init()});
